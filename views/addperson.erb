<h2><%= @action.capitalize %> Person</h2>
<form action="/<%= @action %>/person" method="POST">
    <label>First Name:</label>
    <input type="text" id="first_name" name="first_name" class="required" value="<%= @person[:first_name] %>" />
    <label>Last Name:</label>
    <input type="text" id="last_name" name="last_name" class="required" value="<%= @person[:last_name] %>" />
    <div class="control-group">
      <label class="control-label">Gender</label>
      <div class="controls">
        <div id="gender-buttons" class="btn-group" data-toggle="buttons-radio">
          <button type="button" name="gender" value="male" class="btn <%= (@person[:gender] == 'male' or @person[:gender].nil?) ? 'active' : '' %>">Male</button>
          <button type="button" name="gender" value="female" class="btn <%= (@person[:gender] == 'female') ? 'active' : '' %>">Female</button>
        </div>
      </div>
      <input type="hidden" id="gender" name="gender" value="<%= @person[:gender] or 'male' %>" />
    </div>
    <div class="control-group">
      <label class="control-label">Role:</label>
      <div class="controls">
        <div id="role-buttons" class="btn-group" data-toggle="buttons-radio">
          <button type="button" name="type" value="student" class="btn <%= (@person[:person_type] == :student or @person[:person_type].nil?) ? 'active'  : '' %>">Student</button>
          <button type="button" name="type" value="worker" class="btn <%= @person[:person_type] == :worker ? 'active' : '' %>">Worker</button>
          <button type="button" name="type" value="student_worker" class="btn <%= @person[:person_type] == :student_worker ? 'active' : '' %>">Student Worker</button>
        </div>
      </div>
      <input type="hidden" id="person_type" name="person_type" value="<%= @person[:person_type] or 'student' %>" />
    </div>
    <div class="control-group">
      <label class="control-label">Meeting:</label>
      <div class="controls">
        <%= partial(:meetings, { :meetings => @meetings, :meeting_id => (@person[:meeting_id] or 1), :selection_type => "radio" }) %>
      </div>
    </div>
    <label>Birthday:</label>
    <%= partial(:date, { :current_value => @person[:birthdate], :name => "birthdate" }) %>
    <label>Phone:</label>
    <input type="text" id="phone" name="phone" value="<%= @person[:phone] %>" />
    <label>Address:</label>
    <input type="text" id="address_line1" name="address_line1" value="<%= @person[:address_line1] %>" />
    <label></label>
    <input type="text" id="address_line2" name="address_line2" value="<%= @person[:address_line2] %>" />
    <label>City:</label>
    <input type="text" id="city" name="city" value="<%= @person[:city] %>" />
    <label >State:</label>
    <input type="text" class="span1" id="state" name="state" value="OH" value="<%= @person[:state] %>" />
    <label >Zip:</label>
    <input type="text" class="span2" id="zip" name="zip" class="digits" value="<%= @person[:zip] %>" />
    <label>First Attendance:</label>
    <%= partial(:date, { :current_value => @person[:first_attendance], :name => "first_attendance" }) %>
    <label>Salvation Date:</label>
    <%= partial(:date, { :current_value => @person[:salvation_date], :name => "salvation_date" }) %>
    <label>Baptism Date:</label>
    <%= partial(:date, { :current_value => @person[:baptism_date], :name => "baptism_date" }) %>
    <label>Allergy or Medical Information:</label>
    <textarea rows="3" id="allergy_medical" name="allergy_medical"><%= @person[:allergy_medical] %></textarea>
    <label>Notes:</label>
    <textarea rows="3" id="notes" name="notes" ><%= @person[:notes] %></textarea>
    <div class="well">
      <button class="btn btn-primary" type="submit"><%= @action.capitalize %> Person</button>
    </div>
    <input type="hidden" id="id" name="id" value='<%= @person[:id] %>' />
    <script type="text/javascript">
      $(function () {
        $("form").validate({ 
          errorClass: "error",
          errorElement: "em",
          highlight: function(element, errorClass, validClass) {
            $(element).addClass(errorClass).removeClass(validClass);
            $(element).parents("div.clearfix").addClass(errorClass);
          },
          unhighlight: function(element, errorClass, validClass) {
            $(element).removeClass(errorClass).addClass(validClass);
            $(element).parents("div.clearfix").removeClass(errorClass);
          }
        });
        $("#role-buttons button").bind("load click", function () {
          $("#person_type").val($(this).attr("value"));
        });
        $("#gender-buttons button").bind("load click", function () {
          $("#gender").val($(this).attr("value"));
        });
        $("#meeting-buttons button").bind("load click", function () {
          $("#meeting").val($(this).attr("value"));
        });
      });
    </script>
</form>
