<h2><%= @action.capitalize %> Person</h2>
<form action="/<%= @action %>/person" method="POST">
    <label>First Name:</label>
    <input type="text" id="first_name" name="first_name" value="<%= @person[:first_name] %>" />
    <label>Last Name:</label>
    <input type="text" id="last_name" name="last_name" value="<%= @person[:last_name] %>" />
    <div class="control-group">
      <label class="control-label">Gender</label>
      <div class="controls">
        <%= partial(:selectList, {:values => {"female" => "Female", "male" => "Male"}, :current_value => @person[:gender], :name => "gender" }) %>
      </div>
    </div>
    <div class="control-group">
      <label class="control-label">Role:</label>
      <div class="controls">
        <%= partial(:selectList, {:values => {"1" => "Student", "2" => "Worker", "3" => "Student Worker" }, :current_value => @person[:person_type], :name => "role" }) %>
      </div>
    </div>
    <div class="control-group">
      <label class="control-label">Meeting:</label>
      <div class="controls">
      <%= partial(:selectList, {:values => Hash[@meetings.collect {|m| [ m[:id].to_s, m[:name] ] }], :current_value => params[:meeting], :name => "meeting" }) %>
      </div>
    </div>
    <div class="control-group">
      <label>Birthday:</label>
      <div class="controls">
        <div class="input-append">
          <%= partial(:date, { :current_value => @person[:birthdate], :name => "birthdate" }) %>
        </div>
      </div>
    </div>
    <label>Phone:</label>
    <input type="text" id="phone" name="phone" value="<%= @person[:phone] %>" />
    <label>Address:</label>
    <input type="text" id="address_line1" name="address_line1" value="<%= @person[:address_line1] %>" />
    <label></label>
    <input type="text" id="address_line2" name="address_line2" value="<%= @person[:address_line2] %>" />
    <label>City:</label>
    <input type="text" id="city" name="city" value="<%= @person[:city] %>" />
    <label >State:</label>
    <input type="text" class="span1" id="state" name="state" value="OH" value="<%= @person[:state] %>" />
    <label >Zip:</label>
    <input type="text" id="zip" name="zip" class="span2" value="<%= @person[:zip] %>" />
    <div class="control-group">
      <label>First Attendance:</label>
      <div class="controls">
        <div class="input-append">
          <%= partial(:date, { :current_value => @person[:first_attendance], :name => "first_attendance" }) %>
        </div>
      </div>
    </div>
    <div class="control-group">
      <label>Salvation Date:</label>
      <div class="controls">
        <div class="input-append">
          <%= partial(:date, { :current_value => @person[:salvation_date], :name => "salvation_date" }) %>
        </div>
      </div>
    </div>
    <div class="control-group">
      <label>Baptism Date:</label>
      <div class="controls">
        <div class="input-append">
          <%= partial(:date, { :current_value => @person[:baptism_date], :name => "baptism_date" }) %>
        </div>
      </div>
    </div>
    <label>Allergy or Medical Information:</label>
    <textarea rows="3" id="allergy_medical" name="allergy_medical"><%= @person[:allergy_medical] %></textarea>
    <label>Notes:</label>
    <textarea rows="3" id="notes" name="notes" ><%= @person[:notes] %></textarea>
    <div class="well">
      <input class="btn btn-primary" type="submit" value="<%= @action.capitalize %> Person" />
    </div>
    <input type="hidden" id="id" name="id" value='<%= @person[:id] %>' />
    <script type="text/javascript">
      onInit(function () {
          $("form").validate({ 
            debug: true,
            rules: { 
              first_name: { minlength: 2, required: true },
              last_name: { minlength: 2, required: true },
              zip: { minlength: 5, required: true, digits: true }
            },
            messages: {
              first_name: { minlength: "Please enter more than 2 characters", required: "First name is required" },
              last_name: { minlength: "Please enter more than 2 characters", required: "Last name is required" },
              zip: { minlength: "A zip code must be at least 5 digits", required: "Zip code is required" },
            },
            errorClass: "error",
            highlight: function(element, errorClass, validClass) {
              $(element).addClass(errorClass).removeClass(validClass);
              $(element).parents("div.clearfix").addClass(errorClass);
            },
            unhighlight: function(element, errorClass, validClass) {
              $(element).removeClass(errorClass).addClass(validClass);
              $(element).parents("div.clearfix").removeClass(errorClass);
            }
        });
      });
    </script>
</form>
